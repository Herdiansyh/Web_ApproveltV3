<!DOCTYPE html>
<html dir="ltr" mozdisallowselectionprint moznomarginboxes>
    <head>
        <meta charset="utf-8" />
        <title>PDF.js viewer</title>

        <link
            rel="resource"
            type="application/l10n"
            href="locale/locale.properties"
        />
        <link rel="stylesheet" href="viewer.css" />

        <script src="../build/pdf.js"></script>
        <script src="viewer.js"></script>

        <style>
            html,
            body {
                height: 100%;
                margin: 0;
                overflow: hidden;
            }
            #viewerContainer {
                height: 100%;
                width: 100%;
                position: absolute;
                top: 0;
                left: 0;
                background: #525659;
            }
        </style>
    </head>

    <body tabindex="1">
        <div id="outerContainer">
            <div id="sidebarContainer">
                <div id="toolbarSidebar">
                    <div class="splitToolbarButton toggled">
                        <button
                            id="viewThumbnail"
                            class="toolbarButton"
                            title="Show Thumbnails"
                            tabindex="2"
                            data-l10n-id="thumbs"
                        >
                            <span data-l10n-id="thumbs_label">Thumbnails</span>
                        </button>
                        <button
                            id="viewOutline"
                            class="toolbarButton"
                            title="Show Document Outline"
                            tabindex="3"
                            data-l10n-id="document_outline"
                        >
                            <span data-l10n-id="document_outline_label"
                                >Outline</span
                            >
                        </button>
                    </div>
                </div>
                <div id="sidebarContent">
                    <div id="thumbnailView"></div>
                    <div id="outlineView" class="hidden"></div>
                </div>
            </div>

            <div id="mainContainer">
                <div class="toolbar">
                    <div id="toolbarContainer">
                        <div id="toolbarViewer">
                            <div id="toolbarViewerLeft">
                                <button
                                    id="sidebarToggle"
                                    class="toolbarButton"
                                    title="Toggle Sidebar"
                                    tabindex="4"
                                    data-l10n-id="toggle_sidebar"
                                >
                                    <span data-l10n-id="toggle_sidebar_label"
                                        >Toggle Sidebar</span
                                    >
                                </button>
                                <div class="toolbarButtonSpacer"></div>
                                <button
                                    id="viewFind"
                                    class="toolbarButton"
                                    title="Find in Document"
                                    tabindex="5"
                                    data-l10n-id="findbar"
                                >
                                    <span data-l10n-id="findbar_label"
                                        >Find</span
                                    >
                                </button>
                                <div class="splitToolbarButton">
                                    <button
                                        id="previous"
                                        class="toolbarButton pageUp"
                                        title="Previous Page"
                                        tabindex="6"
                                        data-l10n-id="previous"
                                    >
                                        <span data-l10n-id="previous_label"
                                            >Previous</span
                                        >
                                    </button>
                                    <button
                                        id="next"
                                        class="toolbarButton pageDown"
                                        title="Next Page"
                                        tabindex="7"
                                        data-l10n-id="next"
                                    >
                                        <span data-l10n-id="next_label"
                                            >Next</span
                                        >
                                    </button>
                                </div>
                                <input
                                    type="number"
                                    id="pageNumber"
                                    class="toolbarField pageNumber"
                                    value="1"
                                    size="4"
                                    min="1"
                                />
                                <span id="numPages" class="toolbarLabel"></span>
                            </div>

                            <div id="toolbarViewerRight">
                                <button
                                    id="presentationMode"
                                    class="toolbarButton presentationMode"
                                    title="Presentation Mode"
                                    tabindex="8"
                                    data-l10n-id="presentation_mode"
                                >
                                    <span data-l10n-id="presentation_mode_label"
                                        >Presentation Mode</span
                                    >
                                </button>
                                <button
                                    id="openFile"
                                    class="toolbarButton openFile"
                                    title="Open File"
                                    tabindex="9"
                                    data-l10n-id="open_file"
                                >
                                    <span data-l10n-id="open_file_label"
                                        >Open</span
                                    >
                                </button>
                                <button
                                    id="print"
                                    class="toolbarButton print"
                                    title="Print"
                                    tabindex="10"
                                    data-l10n-id="print"
                                >
                                    <span data-l10n-id="print_label"
                                        >Print</span
                                    >
                                </button>
                                <button
                                    id="download"
                                    class="toolbarButton download"
                                    title="Download"
                                    tabindex="11"
                                    data-l10n-id="download"
                                >
                                    <span data-l10n-id="download_label"
                                        >Download</span
                                    >
                                </button>
                            </div>

                            <div id="toolbarViewerMiddle">
                                <div class="splitToolbarButton">
                                    <button
                                        id="zoomOut"
                                        class="toolbarButton zoomOut"
                                        title="Zoom Out"
                                        tabindex="12"
                                        data-l10n-id="zoom_out"
                                    >
                                        <span data-l10n-id="zoom_out_label"
                                            >Zoom Out</span
                                        >
                                    </button>
                                    <button
                                        id="zoomIn"
                                        class="toolbarButton zoomIn"
                                        title="Zoom In"
                                        tabindex="13"
                                        data-l10n-id="zoom_in"
                                    >
                                        <span data-l10n-id="zoom_in_label"
                                            >Zoom In</span
                                        >
                                    </button>
                                </div>
                                <span
                                    id="scaleSelectContainer"
                                    class="dropdownToolbarButton"
                                >
                                    <select
                                        id="scaleSelect"
                                        title="Zoom"
                                        tabindex="14"
                                        data-l10n-id="zoom"
                                    >
                                        <option
                                            id="pageAutoOption"
                                            value="auto"
                                            selected="selected"
                                            data-l10n-id="page_scale_auto"
                                        >
                                            Automatic Zoom
                                        </option>
                                        <option
                                            id="pageActualOption"
                                            value="page-actual"
                                            data-l10n-id="page_scale_actual"
                                        >
                                            Actual Size
                                        </option>
                                        <option
                                            id="pageFitOption"
                                            value="page-fit"
                                            data-l10n-id="page_scale_fit"
                                        >
                                            Fit Page
                                        </option>
                                        <option
                                            id="pageWidthOption"
                                            value="page-width"
                                            data-l10n-id="page_scale_width"
                                        >
                                            Full Width
                                        </option>
                                        <option value="50">50%</option>
                                        <option value="75">75%</option>
                                        <option value="100">100%</option>
                                        <option value="125">125%</option>
                                        <option value="150">150%</option>
                                        <option value="200">200%</option>
                                        <option value="300">300%</option>
                                        <option value="400">400%</option>
                                    </select>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="viewerContainer">
                    <div id="viewer" class="pdfViewer"></div>
                </div>
            </div>
        </div>

        <script>
            // Ambil parameter file dari URL, contoh: ?file=/view-pdf/123
            const urlParams = new URLSearchParams(window.location.search);
            const file = urlParams.get("file");

            if (file) {
                pdfjsLib.GlobalWorkerOptions.workerSrc =
                    "../build/pdf.worker.js";
                const loadingTask = pdfjsLib.getDocument(file);
                loadingTask.promise.then(function (pdf) {
                    const viewer = document.getElementById("viewer");
                    for (let i = 1; i <= pdf.numPages; i++) {
                        pdf.getPage(i).then(function (page) {
                            const viewport = page.getViewport({ scale: 1.5 });
                            const canvas = document.createElement("canvas");
                            const context = canvas.getContext("2d");
                            canvas.height = viewport.height;
                            canvas.width = viewport.width;
                            viewer.appendChild(canvas);
                            page.render({
                                canvasContext: context,
                                viewport: viewport,
                            });
                        });
                    }
                });
            } else {
                alert("File tidak ditemukan.");
            }
        </script>
    </body>
</html>
